<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>NA • cito</title><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="NA"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">cito</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="articles/A-Introduction_to_cito.html">Introduction to cito</a></li>
    <li><a class="dropdown-item" href="articles/B-Training_neural_networks.html">Training neural networks</a></li>
    <li><a class="dropdown-item" href="articles/C-Example_Species_distribution_modeling.html">Example: (Multi-) Species distribution models with cito</a></li>
    <li><a class="dropdown-item" href="articles/D-Advanced_custom_loss_functions.html">Advanced: Custom loss functions and prediction intervals</a></li>
    <li><a class="dropdown-item" href="articles/E-CNN_and_MMN.html">Convultions neural networks and Multi modal neural networks</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/citoverse/cito/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>NA</h1>
      <small class="dont-index">Source: <a href="https://github.com/citoverse/cito/blob/HEAD/E-CNN_and_MMN.md" class="external-link"><code>E-CNN_and_MMN.md</code></a></small>
    </div>

<div class="section level2">
<h2 id="data-preparation-of-complex-data">Data Preparation of complex data<a class="anchor" aria-label="anchor" href="#data-preparation-of-complex-data"></a></h2>
<p>In Cito, the workflow for preparing complex data for Convolutional Neural Networks (CNNs) and Multimodal Neural Networks (MMNs) is the same. The only difference is that MMNs can process multiple data types simultaneously (see the ‘MMN’ section below).</p>
<p>Before we dive into the details, let’s clarify how we represent different types of complex data in R using multidimensional arrays:</p>
<ul><li>Black/white image: <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mi>h</mi><mi>e</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo>,</mo><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><mi>h</mi><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[height, width]</annotation></semantics></math> with height/width being the number of pixels</li>
<li>Colored images: <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mn>3</mn><mo>,</mo><mi>h</mi><mi>e</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo>,</mo><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><mi>h</mi><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[3, height, width]</annotation></semantics></math> 3 channels for the three colors</li>
<li>LiDAR point clouds: <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[x, y, z]</annotation></semantics></math></li>
<li>Environmental time series (can be also represented by an “image”): <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mtext mathvariant="normal">time_steps</mtext><mo>,</mo><mtext mathvariant="normal">n_covariates</mtext><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[\text{time_steps}, \text{n_covariates}]</annotation></semantics></math></li>
</ul><p>Note: Cito currently supports up to three-dimensional inputs (excluding the sample dimension). Four-dimensional arrays, such as temporal RGB sequences <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mn>3</mn><mo>,</mo><mi>h</mi><mi>e</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo>,</mo><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><mi>h</mi><mo>,</mo><mi>t</mi><mi>i</mi><mi>m</mi><msub><mi>e</mi><mi>s</mi></msub><mi>t</mi><mi>e</mi><mi>p</mi><mi>s</mi><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[3, height, width, time_steps]</annotation></semantics></math>, are not yet supported. Please contact us if you need support for 4D inputs.</p>
<div class="section level3">
<h3 id="the-format-of-the-inputs-we-expect-in-cito">The format of the inputs we expect in cito<a class="anchor" aria-label="anchor" href="#the-format-of-the-inputs-we-expect-in-cito"></a></h3>
<p>The <code><a href="reference/cnn.html">cnn()</a></code> and <code><a href="reference/mmn.html">mmn()</a></code> functions both expect their X argument to be a single array, with the first dimension indexing samples. The subsequent dimensions then correspond to the data structure of each sample. Specifically:</p>
<ul><li>Grayscale images: <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mtext mathvariant="normal">n_samples</mtext><mo>,</mo><mi>h</mi><mi>e</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo>,</mo><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><mi>h</mi><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[\text{n_samples}, height, width]</annotation></semantics></math></li>
<li>RGB images: <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mtext mathvariant="normal">n_samples</mtext><mo>,</mo><mn>3</mn><mo>,</mo><mi>h</mi><mi>e</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo>,</mo><mi>w</mi><mi>i</mi><mi>d</mi><mi>t</mi><mi>h</mi><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[\text{n_samples}, 3, height, width]</annotation></semantics></math></li>
<li>LiDAR point clouds: <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mtext mathvariant="normal">n_samples</mtext><mo>,</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[\text{n_samples}, x, y, z]</annotation></semantics></math></li>
<li>Time series data: <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mtext mathvariant="normal">n_samples</mtext><mo>,</mo><mi>t</mi><mi>i</mi><mi>m</mi><msub><mi>e</mi><mi>s</mi></msub><mi>t</mi><mi>e</mi><mi>p</mi><mi>s</mi><mo>,</mo><msub><mi>n</mi><mi>c</mi></msub><mi>o</mi><mi>v</mi><mi>a</mi><mi>r</mi><mi>i</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>s</mi><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[\text{n_samples}, time_steps, n_covariates]</annotation></semantics></math></li>
</ul><p>It is crucial that the order of samples in X matches the order of observations in your response (target) vector (or matrix for multiple response) y.</p>
<p>Ultimately, the only requirement for cito is that it has these multidimensional arrays as inputs. Please note that there are several ways in which we can build them; the following workflow is just one example.</p>
</div>
<div class="section level3">
<h3 id="id_1-preparing-your-data-on-disk">1. Preparing your data on disk<a class="anchor" aria-label="anchor" href="#id_1-preparing-your-data-on-disk"></a></h3>
<p>Although images can be saved in different formats, we recommend using formats for which an R function or R package is available to allow you to load the images into R.</p>
<p>Grayscale and RGB images should be saved as <code>.png</code> or <code>.jpeg</code>. Time series data can technically be interpreted as grayscale images and should therefore also be saved as <code>.png</code> or <code>.jpeg</code>.</p>
<p>However, LiDAR point clouds and/or other remote sensing data have more ‘channels’ (ofc, they do not have channels at all) than grayscale or RGB images and cannot therefore be saved as <code>.png</code> or <code>.jpeg</code>. Classical formats for saving such data are <code>.tiff</code> (GeoTiff) and <code>.nc</code> (netCDF).</p>
<p>We recommend saving each image individually to your hard drive and using a naming strategy that allows the observation ID to be inferred from the image name. Here is an example:</p>
<pre><code>project/
├── data/
│   ├── RGBimages/
│   │   ├── 001-img.jpeg
│   │   ├── 002-img.jpeg
│   │   ├── 003-img.jpeg
│   │   ├── 004-img.jpeg
│   │   └── ...
│   ├── LiDAR/
│   │   ├── 001-LiDAR.tiff
│   │   ├── 002-LiDAR.tiff
│   │   ├── 003-LiDAR.tiff
│   │   ├── 004-LiDAR.tiff
│   │   └── ...
│   └── Response/
│       └── Y.csv
└── code/
    ├── 01-MMN.R
    └── 02-CNN.R</code></pre>
</div>
<div class="section level3">
<h3 id="id_2-load-images-into-r">2. Load images into R<a class="anchor" aria-label="anchor" href="#id_2-load-images-into-r"></a></h3>
<p>Before we can run/train cito, we must load the images into R, transform them into arrays, and concatenate the individual images of one input type into one array.</p>
<ul><li>Reading <code>.jpeg</code> files: Can be done either using the <code>imager</code> package via <code>as.array(imager::load.image("path-to-img.jpeg")))</code> or using the <code>torchvision</code> package (dependency of cito) via <code>torchvision::base_loader("path-to-img.jpeg")</code>
</li>
<li>Reading <code>.png</code> files: Can be done using the <code>torchvision</code> package (dependency of cito) via <code>torchvision::base_loader("path-to-img.jpeg")</code>
</li>
<li>Reading <code>.tiff</code> files: <code>tiff::readTIFF("path-to-img.tiff")</code>
</li>
<li>Reading <code>.tiff</code> (GeoTIFF) files: <code>as.array(raster::brick("path-to-img.tiff"))</code>
</li>
</ul></div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Christian Amesöder, Maximilian Pichler.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

